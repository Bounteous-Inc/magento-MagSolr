<?xml version="1.0" encoding="UTF-8" ?>
<!--
	The config name property is constructed as follows

	Asm_Solr  -  The module name
	x-y-z     -  The module version this config is meant to work with
	YYYYMMDD  -  The date the config file was changed the last time

	When changing the schema the name property must be updated, too.
-->
<config name="Asm_Solr-0-1-0--20130923">

	<luceneMatchVersion>4.4</luceneMatchVersion>


	<!-- Tika / Solr Cell -->
	<lib dir="../contrib/extraction/lib" regex=".*\.jar" />
	<lib dir="../dist/" regex="solr-cell-\d.*\.jar" />

	<!-- Clustering -->
	<lib dir="../contrib/clustering/lib/" regex=".*\.jar" />
	<lib dir="../dist/" regex="solr-clustering-\d.*\.jar" />

	<!-- Data Import Handler -->
	<lib dir="../contrib/dataimporthandler/lib/" regex=".*\.jar" />
	<lib dir="../dist/" regex="solr-dataimporthandler-\d.*\.jar" />

	<!-- Language Analysis Extras -->
	<lib dir="../contrib/analysis-extras/lib/" regex=".*\.jar" />
	<lib dir="../contrib/analysis-extras/lucene-libs/" regex=".*\.jar" />
	<lib dir="../dist/" regex="solr-analysis-extras-\d.*\.jar" />

	<!-- Language Identification -->
	<lib dir="../contrib/langid/lib/" regex=".*\.jar" />
	<lib dir="../dist/" regex="solr-langid-\d.*\.jar" />

	<!-- Velocity Template Engine -->
	<lib dir="../contrib/velocity/lib" regex=".*\.jar" />
	<lib dir="../dist/" regex="solr-velocity-\d.*\.jar" />


	<directoryFactory name="DirectoryFactory" class="solr.NRTCachingDirectoryFactory"/>

	<codecFactory class="solr.SchemaCodecFactory"/>

	<!--
		Enabling dynamic schema REST APIs.

		Do NOT hand edit the managed schema - external modifications will be ignored and
		overwritten as a result of schema modification REST API calls.
	-->
	<schemaFactory class="ManagedIndexSchemaFactory">
		<bool name="mutable">true</bool>
		<str name="managedSchemaResourceName">managed-schema.xml</str>
	</schemaFactory>


	<indexConfig>

		<lockType>native</lockType>
		<infoStream>true</infoStream>

	</indexConfig>


	<!-- The default high-performance update handler -->
	<updateHandler class="solr.DirectUpdateHandler2">

		<updateLog>
			<str name="dir">${solr.ulog.dir:}</str>
		</updateLog>

		<autoCommit>
			<maxDocs>100</maxDocs>
			<maxTime>3600000</maxTime>
			<openSearcher>true</openSearcher>
		</autoCommit>

		<autoSoftCommit>
			<maxTime>1000</maxTime>
		</autoSoftCommit>

	</updateHandler>


	<query>
		<maxBooleanClauses>1024</maxBooleanClauses>

		<filterCache class="solr.FastLRUCache" size="512" initialSize="512" autowarmCount="256" />

		<queryResultCache class="solr.LRUCache" size="512" initialSize="512" autowarmCount="256" />

		<documentCache class="solr.LRUCache" size="512" initialSize="512" autowarmCount="0" />

		<enableLazyFieldLoading>true</enableLazyFieldLoading>

		<queryResultWindowSize>50</queryResultWindowSize>

		<queryResultMaxDocsCached>200</queryResultMaxDocsCached>

		<listener event="newSearcher" class="solr.QuerySenderListener">
			<arr name="queries">
			</arr>
		</listener>
		<listener event="firstSearcher" class="solr.QuerySenderListener">
			<arr name="queries">
			</arr>
		</listener>

		<useColdSearcher>false</useColdSearcher>

		<maxWarmingSearchers>5</maxWarmingSearchers>
	</query>


	<requestDispatcher handleSelect="false" >
		<!-- Make sure your system has some authentication! before using enableRemoteStreaming="true" -->
		<requestParsers enableRemoteStreaming="true"
			multipartUploadLimitInKB="2048000"
			formdataUploadLimitInKB="2048"
			addHttpRequestToContext="false" />

		<httpCaching never304="true" />
	</requestDispatcher>


	<requestHandler name="/select" class="solr.SearchHandler">
		<lst name="defaults">
			<defType>edismax</defType>
			<str name="echoParams">explicit</str>
			<str name="q.op">OR</str>
			<str name="qf">content^40.0 title^5.0 keywords^2.0 tagsH1^5.0 tagsH2H3^3.0 tagsH4H5H6^2.0 tagsInline^1.0</str>
			<str name="pf">content^2.0</str>
			<str name="df">content</str>
			<int name="ps">15</int>

			<str name="mm">2&lt;-35%</str>

			<str name="hl.fl">title,content</str>
			<int name="hl.snippets">3</int>
			<str name="hl.mergeContiguous">true</str>
			<str name="hl.requireFieldMatch">true</str>

			<str name="f.content.hl.alternateField">content</str>
			<str name="f.content.hl.maxAlternateFieldLength">200</str>

			<str name="spellcheck">false</str>
			<str name="spellcheck.onlyMorePopular">false</str>
			<str name="spellcheck.extendedResults">false</str>
			<str name="spellcheck.count">1</str>

			<str name="wt">json</str>
			<str name="indent">true</str>
		</lst>

		<arr name="last-components">
			<str>spellcheck</str>
			<str>elevator</str>
		</arr>

	</requestHandler>


	<requestHandler name="/get" class="solr.RealTimeGetHandler">
		<lst name="defaults">
			<str name="omitHeader">true</str>
			<str name="wt">json</str>
			<str name="indent">true</str>
		</lst>
	</requestHandler>


	<requestHandler name="/browse" class="solr.SearchHandler">
		<lst name="defaults">
			<str name="echoParams">explicit</str>

			<!-- VelocityResponseWriter settings -->
			<str name="wt">velocity</str>
			<str name="v.template">browse</str>
			<str name="v.layout">layout</str>
			<str name="title">Solritas</str>

			<!-- Query settings -->
			<str name="df">content</str>
			<str name="defType">edismax</str>
			<str name="q.alt">*:*</str>
			<str name="rows">10</str>
			<str name="fl">*,score</str>
			<str name="mlt.qf">content^0.5 title^1.2 keywords^2.0</str>
			<str name="mlt.fl">content,title,keywords</str>
			<int name="mlt.count">3</int>

			<str name="qf">content^40.0 title^5.0 keywords^2.0 tagsH1^5.0 tagsH2H3^3.0 tagsH4H5H6^2.0 tagsInline^1.0</str>

			<str name="facet">on</str>
			<str name="facet.field">type</str>
			<str name="facet.field">site</str>
			<str name="facet.field">keywords</str>
			<str name="facet.field">appKey</str>
			<str name="facet.mincount">1</str>

			<str name="spellcheck">on</str>
			<str name="spellcheck.collate">true</str>

			<!-- Highlighting defaults -->
			<str name="hl">on</str>
			<str name="hl.fl">title content</str>
			<str name="hl.encoder">html</str>
			<str name="hl.simple.pre">&lt;b&gt;</str>
			<str name="hl.simple.post">&lt;/b&gt;</str>
		</lst>
		<arr name="last-components">
			<str>spellcheck</str>
		</arr>
	</requestHandler>


	<requestHandler name="mlt" class="solr.MoreLikeThisHandler">
		<lst name="defaults">
			<str name="mlt.mintf">1</str>
			<str name="mlt.mindf">1</str>
			<str name="mlt.minwl">3</str>
			<str name="mlt.maxwl">15</str>
			<str name="mlt.maxqt">20</str>
			<str name="mlt.match.include">false</str>
		</lst>
	</requestHandler>


	<requestHandler name="/update" class="solr.UpdateRequestHandler" />


	<requestHandler name="/update/extract" class="solr.extraction.ExtractingRequestHandler" startup="lazy" />


	<requestHandler name="/analysis/field" class="solr.FieldAnalysisRequestHandler" startup="lazy" />


	<requestHandler name="/analysis/document" class="solr.DocumentAnalysisRequestHandler" startup="lazy" />


	<requestHandler name="/admin/" class="solr.admin.AdminHandlers" />


	<requestHandler name="/admin/ping" class="solr.PingRequestHandler">
		<lst name="invariants">
			<str name="q">solrpingquery</str>
		</lst>
		<lst name="defaults">
			<str name="echoParams">all</str>
			<str name="df">id</str>
		</lst>
	</requestHandler>

	<!-- Echo the request contents back to the client -->
	<requestHandler name="/debug/dump" class="solr.DumpRequestHandler">
		<lst name="defaults">
			<str name="echoParams">explicit</str>
			<str name="echoHandler">true</str>
		</lst>
	</requestHandler>


	<requestHandler name="/replication" class="solr.ReplicationHandler" >
		<!--
		   To enable simple master/slave replication, uncomment one of the
		   sections below, depending on whether this solr instance should be
		   the "master" or a "slave".  If this instance is a "slave" you will
		   also need to fill in the masterUrl to point to a real machine.
		-->
		<!--
		   <lst name="master">
			 <str name="replicateAfter">commit</str>
			 <str name="replicateAfter">startup</str>
			 <str name="confFiles">schema.xml,stopwords.txt</str>
		   </lst>
		-->
		<!--
		   <lst name="slave">
			 <str name="masterUrl">http://your-master-hostname:8983/solr</str>
			 <str name="pollInterval">00:00:60</str>
		   </lst>
		-->
	</requestHandler>


	<searchComponent name="spellcheck" class="solr.SpellCheckComponent">
		<str name="queryAnalyzerFieldType">textSpell</str>

		<lst name="spellchecker">
			<str name="name">default</str>
			<str name="field">spellcheckContent</str>
			<str name="classname">solr.DirectSolrSpellChecker</str>
			<str name="distanceMeasure">internal</str>
			<float name="accuracy">0.5</float>
			<int name="maxEdits">2</int>
			<int name="minPrefix">1</int>
			<int name="maxInspections">5</int>
			<int name="minQueryLength">3</int>
			<float name="maxQueryFrequency">0.01</float>
		</lst>
	</searchComponent>


	<searchComponent name="terms" class="solr.TermsComponent"/>

	<requestHandler name="/terms" class="solr.SearchHandler" startup="lazy">
		<lst name="defaults">
			<bool name="terms">true</bool>
			<bool name="distrib">false</bool>
		</lst>
		<arr name="components">
			<str>terms</str>
		</arr>
	</requestHandler>


	<searchComponent name="elevator" class="solr.QueryElevationComponent" >
		<str name="queryFieldType">string</str>
		<str name="config-file">elevate.xml</str>
		<str name="forceElevation">true</str>
	</searchComponent>


	<searchComponent name="highlight" class="solr.HighlightComponent">
		<highlighting>
			<!-- standard fragmenter -->
			<fragmenter name="gap" default="true" class="solr.highlight.GapFragmenter">
				<lst name="defaults">
					<int name="hl.fragsize">100</int>
				</lst>
			</fragmenter>

			<!-- standard formatter -->
			<formatter name="html" default="true" class="solr.highlight.HtmlFormatter">
				<lst name="defaults">
					<str name="hl.simple.pre"><![CDATA[<em>]]></str>
					<str name="hl.simple.post"><![CDATA[</em>]]></str>
				</lst>
			</formatter>

			<!-- standard encoder -->
			<encoder name="html" class="solr.highlight.HtmlEncoder" />


			<!-- standard fragListBuilder -->
			<fragListBuilder name="simple" class="solr.highlight.SimpleFragListBuilder" />

			<!-- single fragListBuilder -->
			<fragListBuilder name="single" class="solr.highlight.SingleFragListBuilder" />

			<!-- weighted fragListBuilder -->
			<fragListBuilder name="weighted" class="solr.highlight.WeightedFragListBuilder" default="true" />


			<!-- default tag FragmentsBuilder -->
			<fragmentsBuilder name="default" class="solr.highlight.ScoreOrderFragmentsBuilder" default="true">
				<!--
				<lst name="defaults">
				  <str name="hl.multiValuedSeparatorChar">/</str>
				</lst>
				-->
			</fragmentsBuilder>

			<!-- multi-colored tag FragmentsBuilder -->
			<fragmentsBuilder name="colored" class="solr.highlight.ScoreOrderFragmentsBuilder">
				<lst name="defaults">
					<str name="hl.tag.pre"><![CDATA[
               <strong style="background:yellow">,<strong style="background:lawgreen">,
               <strong style="background:aquamarine">,<strong style="background:magenta">,
               <strong style="background:palegreen">,<strong style="background:coral">,
               <strong style="background:wheat">,<strong style="background:khaki">,
               <strong style="background:lime">,<strong style="background:deepskyblue">]]></str>
					<str name="hl.tag.post"><![CDATA[</strong>]]></str>
				</lst>
			</fragmentsBuilder>

			<boundaryScanner name="default" class="solr.highlight.SimpleBoundaryScanner" default="true">
				<lst name="defaults">
					<str name="hl.bs.maxScan">10</str>
					<str name="hl.bs.chars">.,!? &#9;&#10;&#13;</str>
				</lst>
			</boundaryScanner>

			<boundaryScanner name="breakIterator" class="solr.highlight.BreakIteratorBoundaryScanner">
				<lst name="defaults">
					<str name="hl.bs.type">WORD</str>
					<str name="hl.bs.language">en</str>
					<str name="hl.bs.country">US</str>
				</lst>
			</boundaryScanner>
		</highlighting>
	</searchComponent>


	<queryResponseWriter name="json" class="solr.JSONResponseWriter" default="true" />

	<queryResponseWriter name="velocity" class="solr.VelocityResponseWriter" startup="lazy" />


	<!-- http://wiki.apache.org/solr/DocTransformers -->
	<!-- Document Transformer to mark elevated documents -->
	<transformer name="elevated" class="org.apache.solr.response.transform.ElevatedMarkerFactory" />

	<!-- Document Transformer to add scoring explaination in HTML to show score analysis -->
	<transformer name="explain" class="org.apache.solr.response.transform.ExplainAugmenterFactory" >
		<str name="args">html</str>
	</transformer>


	<admin>
		<defaultQuery>*:*</defaultQuery>
	</admin>

</config>